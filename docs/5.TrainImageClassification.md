# Huấn luyện Image Classification Model

-----
## Train với src/classification/train.py

### Output:
```
Số lượng lớp: 12
Các lớp: ['0', '1', '10', '11', '2', '3', '4', '5', '6', '7', '8', '9']
Số lượng ảnh train: 3870
Số lượng ảnh validation: 961
==================== BẮT ĐẦU HUẤN LUYỆN ====================
Thiết bị: mps
Epochs: 50, Batch size: 32, Learning rate: 0.001
============================================================

Epoch 1/50 [Train]: 100%|████████████████████████████████| 120/120 [00:18<00:00,  6.62it/s, loss=1.4719]
Epoch 1/50 [Val]: 100%|████████████████████████████████████| 31/31 [00:12<00:00,  2.41it/s, loss=3.3224]

Epoch 1/50 - Time: 30.98s
Train Loss: 1.3758, Train Acc: 0.6766
Val Loss: 1.2452, Val Acc: 0.6961
[BEST] Đã lưu model với accuracy: 0.6961
Epoch 2/50 [Train]: 100%|████████████████████████████████| 120/120 [00:17<00:00,  6.92it/s, loss=1.3482]
Epoch 2/50 [Val]: 100%|████████████████████████████████████| 31/31 [00:12<00:00,  2.50it/s, loss=1.9259]

Epoch 2/50 - Time: 29.75s
Train Loss: 1.1517, Train Acc: 0.7010
Val Loss: 0.9825, Val Acc: 0.7263
[BEST] Đã lưu model với accuracy: 0.7263

...

Epoch 48/50 - Time: 29.59s
Train Loss: 0.2065, Train Acc: 0.9211
Val Loss: 0.3250, Val Acc: 0.8835
Epoch 49/50 [Train]: 100%|███████████████████████████████| 120/120 [00:17<00:00,  6.98it/s, loss=0.3393]
Epoch 49/50 [Val]: 100%|███████████████████████████████████| 31/31 [00:12<00:00,  2.49it/s, loss=0.2324]

Epoch 49/50 - Time: 29.63s
Train Loss: 0.1975, Train Acc: 0.9253
Val Loss: 0.3194, Val Acc: 0.8876
Epoch 50/50 [Train]: 100%|███████████████████████████████| 120/120 [00:17<00:00,  6.96it/s, loss=0.0626]
Epoch 50/50 [Val]: 100%|███████████████████████████████████| 31/31 [00:12<00:00,  2.51it/s, loss=0.1391]

Epoch 50/50 - Time: 29.63s
Train Loss: 0.1948, Train Acc: 0.9281
Val Loss: 0.3111, Val Acc: 0.8845

==================== HUẤN LUYỆN HOÀN TẤT ====================
Best validation accuracy: 0.8897
Model đã được lưu tại: ./models/classification
```

## Đánh giá với src/classification/evaluate.py

### Output:
```
Số lượng lớp: 12
Các lớp: ['0', '1', '10', '11', '2', '3', '4', '5', '6', '7', '8', '9']
Số lượng ảnh validation: 961
Đã load model thành công từ: ./models/classification/best.pt

Đang đánh giá model...
Evaluating: 100%|███████████████████████████████████████████████████████| 31/31 [00:12<00:00,  2.47it/s]
Accuracy: 0.8897

Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.96      0.93       659
           1       0.88      0.78      0.82        27
          10       0.75      1.00      0.86         9
          11       0.92      0.65      0.76        51
           2       1.00      1.00      1.00        21
           3       0.73      0.92      0.81        26
           4       1.00      0.56      0.71        18
           5       0.92      0.80      0.85        44
           6       0.67      0.40      0.50        15
           7       0.91      0.65      0.75        31
           8       0.84      0.75      0.79        28
           9       0.92      0.72      0.81        32

    accuracy                           0.89       961
   macro avg       0.87      0.76      0.80       961
weighted avg       0.89      0.89      0.88       961

Đã lưu confusion matrix tại 'src/classification/evaluation_results/confusion_matrix.png'
Đã lưu mẫu dự đoán tại 'src/classification/evaluation_results/prediction_samples.png'
```

## Đánh giá:

Mô hình đạt hiệu suất rất tốt với **accuracy tổng thể là 88.97%**, điều này cho thấy mô hình đã học được cách phân biệt giữa các số áo cầu thủ một cách hiệu quả.