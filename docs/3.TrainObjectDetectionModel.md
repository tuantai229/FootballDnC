# Huáº¥n luyá»‡n Object Detection Model

-----
## Train vá»›i src/detection/train_basic.py

### Output:
```
50 epochs completed in 0.272 hours.
Optimizer stripped from ../../models/detection/basic_train/weights/last.pt, 5.4MB
Optimizer stripped from ../../models/detection/basic_train/weights/best.pt, 5.4MB

Validating ../../models/detection/basic_train/weights/best.pt...
Ultralytics 8.3.81 ðŸš€ Python-3.10.16 torch-2.6.0 MPS (Apple M2 Pro)
YOLO11n summary (fused): 100 layers, 2,582,542 parameters, 0 gradients, 6.3 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                   all         87       1039      0.939       0.41      0.448      0.214
                  ball         86        170          1          0          0          0
                player         87        869      0.879      0.819      0.896      0.428
Speed: 0.2ms preprocess, 41.1ms inference, 0.0ms loss, 8.1ms postprocess per image
Results saved to ../../models/detection/basic_train
Huáº¥n luyá»‡n hoÃ n thÃ nh!
```

### ÄÃ¡nh giÃ¡:

1. **Thá»i gian huáº¥n luyá»‡n**: ~16 phÃºt cho 50 epochs (0.272 giá»)

2. **Káº¿t quáº£ phÃ¡t hiá»‡n**:
   - **Cáº§u thá»§ (player)**: Tá»‘t vá»›i precision 0.879, recall 0.819, mAP50 lÃ  0.896
   - **BÃ³ng (ball)**: KhÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c (precision 1.0 nhÆ°ng recall 0 vÃ  mAP 0)
   - **Tá»•ng thá»ƒ**: mAP50 Ä‘áº¡t 0.448 vÃ  mAP50-95 Ä‘áº¡t 0.214


### Váº¥n Ä‘á» cáº§n kháº¯c phá»¥c
KhÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c bÃ³ng. NguyÃªn nhÃ¢n cÃ³ thá»ƒ lÃ :
- BÃ³ng cÃ³ kÃ­ch thÆ°á»›c quÃ¡ nhá» trong áº£nh 3840x1200 khi resize xuá»‘ng 640x640
- Sá»‘ lÆ°á»£ng máº«u bÃ³ng (170) Ã­t hÆ¡n nhiá»u so vá»›i cáº§u thá»§ (869)

-----
## Train vá»›i script cáº£i tiáº¿n láº§n 1: src/detectiontrain_improve1.py

### CÃ¡c cáº£i tiáº¿n

#### 1. TÄƒng kÃ­ch thÆ°á»›c áº£nh
- **imgsz=1280**: TÄƒng tá»« 640 lÃªn 1280 Ä‘á»ƒ giá»¯ láº¡i nhiá»u chi tiáº¿t hÆ¡n, Ä‘áº·c biá»‡t lÃ  vá»›i quáº£ bÃ³ng nhá»
- **batch=8**: Giáº£m batch size Ä‘á»ƒ phÃ¹ há»£p vá»›i bá»™ nhá»› GPU khi xá»­ lÃ½ áº£nh lá»›n hÆ¡n

#### 2. Äiá»u chá»‰nh loss weights
- **box=7.5**: Giá»¯ nguyÃªn trá»ng sá»‘ cho box loss
- **cls=0.5**: Giá»¯ nguyÃªn trá»ng sá»‘ cho class loss

#### 3. Báº­t augmentation
- **fliplr=0.5**: Láº­t ngang áº£nh vá»›i xÃ¡c suáº¥t 50% Ä‘á»ƒ tÄƒng tÃ­nh Ä‘a dáº¡ng dá»¯ liá»‡u
- **scale=0.5**: Thay Ä‘á»•i tá»· lá»‡ áº£nh Ä‘á»ƒ huáº¥n luyá»‡n mÃ´ hÃ¬nh nháº­n diá»‡n Ä‘á»‘i tÆ°á»£ng á»Ÿ nhiá»u kÃ­ch thÆ°á»›c
- **mosaic=1.0**: GhÃ©p 4 áº£nh thÃ nh 1 Ä‘á»ƒ tÄƒng Ä‘a dáº¡ng vÃ  máº­t Ä‘á»™ Ä‘á»‘i tÆ°á»£ng

#### 4. Tá»‘i Æ°u hÃ³a cho Mac M2
- **workers=2**: Giáº£m sá»‘ worker threads Ä‘á»ƒ trÃ¡nh quÃ¡ táº£i há»‡ thá»‘ng
- **half=True**: Sá»­ dá»¥ng half precision (FP16) Ä‘á»ƒ tÄƒng tá»‘c quÃ¡ trÃ¬nh huáº¥n luyá»‡n

### Output

```
...
      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size
      22/50      10.6G      1.108        0.9     0.8667         45       1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 16/16 [0
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):   0%|         WARNING âš ï¸ NMS time limit 2.800s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):  17%|â–ˆâ–‹       WARNING âš ï¸ NMS time limit 2.800s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):  33%|â–ˆâ–ˆâ–ˆâ–Ž     WARNING âš ï¸ NMS time limit 2.800s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    WARNING âš ï¸ NMS time limit 2.800s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  WARNING âš ï¸ NMS time limit 2.800s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95):  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ŽWARNING âš ï¸ NMS time limit 2.350s exceeded
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                   all         87       1039      0.942       0.17      0.181      0.125
EarlyStopping: Training stopped early as no improvement observed in last 15 epochs. Best results observed at epoch 7, best model saved as best.pt.
To update EarlyStopping(patience=15) pass a new patience value, i.e. `patience=300` or use `patience=0` to disable EarlyStopping.

22 epochs completed in 0.624 hours.
Optimizer stripped from ../../models/detection/improved_train/weights/last.pt, 5.5MB
Optimizer stripped from ../../models/detection/improved_train/weights/best.pt, 5.5MB

Validating ../../models/detection/improved_train/weights/best.pt...
Ultralytics 8.3.81 ðŸš€ Python-3.10.16 torch-2.6.0 MPS (Apple M2 Pro)
YOLO11n summary (fused): 100 layers, 2,582,542 parameters, 0 gradients, 6.3 GFLOPs
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                   all         87       1039      0.963      0.405      0.468       0.29
                  ball         86        170          1          0          0          0
                player         87        869      0.926       0.81      0.937       0.58
Speed: 0.5ms preprocess, 43.7ms inference, 0.0ms loss, 92.8ms postprocess per image
Results saved to ../../models/detection/improved_train
Huáº¥n luyá»‡n cáº£i tiáº¿n hoÃ n thÃ nh!
```

### ÄÃ¡nh giÃ¡:

- Script dá»«ng á»Ÿ epoch 22/50 do cÆ¡ cháº¿ Early Stopping Ä‘Æ°á»£c kÃ­ch hoáº¡t
- MÃ´ hÃ¬nh tá»‘t nháº¥t Ä‘Æ°á»£c lÆ°u á»Ÿ epoch 7

Káº¿t quáº£ cÃ³ má»™t sá»‘ cáº£i thiá»‡n nhÆ°ng váº«n cÃ²n váº¥n Ä‘á»:

|            | CÆ¡ báº£n (640) | Cáº£i tiáº¿n (1280) |
|------------|--------------|-----------------|
| mAP50      | 0.448        | 0.468           |
| mAP50-95   | 0.214        | 0.290           |
| Player mAP | 0.428        | 0.580           |
| Ball mAP   | 0.000        | 0.000           |

**Káº¿t luáº­n chÃ­nh**: MÃ´ hÃ¬nh cáº£i thiá»‡n kháº£ nÄƒng phÃ¡t hiá»‡n cáº§u thá»§ nhÆ°ng váº«n **khÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c bÃ³ng**.

-----
## Train vá»›i script cáº£i tiáº¿n láº§n 2: src/detectiontrain_improve2.py

### CÃ¡c cáº£i tiáº¿n

1. Äiá»u chá»‰nh cÃ¢n báº±ng lá»›p
```python
# [ball_weight, player_weight] - bÃ³ng:5.0, cáº§u thá»§:1.0
class_weights = torch.tensor([5.0, 1.0])
```
- **LÃ½ do**: BÃ³ng cÃ³ Ã­t máº«u hÆ¡n cáº§u thá»§ (170 vs 869, tá»· lá»‡ khoáº£ng 1:5)
- **CÃ¡ch hoáº¡t Ä‘á»™ng**: Khi má»™t quáº£ bÃ³ng bá»‹ bá» sÃ³t, mÃ´ hÃ¬nh sáº½ bá»‹ pháº¡t náº·ng hÆ¡n 5 láº§n so vá»›i viá»‡c bá» sÃ³t má»™t cáº§u thá»§
- **Ká»³ vá»ng**: MÃ´ hÃ¬nh sáº½ "cá»‘ gáº¯ng hÆ¡n" Ä‘á»ƒ tÃ¬m vÃ  phÃ¡t hiá»‡n bÃ³ng

2. Äiá»u chá»‰nh trá»ng sá»‘ loss
```python
box=10.0,  # TÄƒng tá»« 7.5 lÃªn 10.0
cls=2.0,  # TÄƒng tá»« 0.5 lÃªn 2.0
```
- **Box loss**: TÄƒng Ä‘á»ƒ mÃ´ hÃ¬nh táº­p trung hÆ¡n vÃ o vá»‹ trÃ­ chÃ­nh xÃ¡c cá»§a Ä‘á»‘i tÆ°á»£ng nhá»
- **Class loss**: TÄƒng Ä‘á»ƒ mÃ´ hÃ¬nh nháº­n diá»‡n chÃ­nh xÃ¡c cÃ¡c lá»›p tá»‘t hÆ¡n ("pháº¡t" máº¡nh hÆ¡n khi mÃ´ hÃ¬nh phÃ¢n loáº¡i sai hoáº·c bá» sÃ³t Ä‘á»‘i tÆ°á»£ng báº¥t ká»³)

3. Cáº£i thiá»‡n augmentation cho Ä‘á»‘i tÆ°á»£ng nhá»
```python
scale=0.7,      # TÄƒng tá»« 0.5
mixup=0.3,      # ThÃªm má»›i
copy_paste=0.1, # ThÃªm má»›i
```
- **Scale**: TÄƒng biáº¿n Ä‘á»•i tá»· lá»‡ Ä‘á»ƒ táº¡o ra nhiá»u kÃ­ch thÆ°á»›c Ä‘á»‘i tÆ°á»£ng
- **Mixup**: Trá»™n hai áº£nh vá»›i nhau, giÃºp mÃ´ hÃ¬nh há»c cÃ¡c Ä‘áº·c trÆ°ng tá»‘t hÆ¡n
- **Copy-paste**: Sao chÃ©p Ä‘á»‘i tÆ°á»£ng tá»« áº£nh nÃ y sang áº£nh khÃ¡c, Ä‘áº·c biá»‡t há»¯u Ã­ch cho lá»›p cÃ³ Ã­t máº«u

1. TÄƒng thá»i gian huáº¥n luyá»‡n
```python
epochs=80,    # TÄƒng tá»« 50
patience=30,  # TÄƒng tá»« 15
```
Cho mÃ´ hÃ¬nh nhiá»u thá»i gian há»c hÆ¡n

### QuÃ¡ trÃ¬nh thá»±c hiá»‡n

Script cháº¡y Ä‘áº¿n Epoch 66/80 thÃ¬ bÃ¡o lá»—i: 
```
RuntimeError: MPS backend out of memory (MPS allocated: 12.13 GB, other allocations: 5.81 GB, max allowed: 18.13 GB). Tried to allocate 200.00 MB on private pool. Use PYTORCH_MPS_HIGH_WATERMARK_RATIO=0.0 to disable upper limit for memory allocations (may cause system failure).
```

Lá»—i nÃ y xáº£y ra khi GPU háº¿t bá»™ nhá»› trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n:
- **MPS Ä‘Ã£ cáº¥p phÃ¡t**: 12.13 GB
- **CÃ¡c pháº§n khÃ¡c Ä‘ang sá»­ dá»¥ng**: 5.81 GB 
- **Tá»•ng giá»›i háº¡n**: 18.13 GB
- Khi cá»‘ gáº¯ng cáº¥p phÃ¡t thÃªm 200 MB, há»‡ thá»‘ng khÃ´ng thá»ƒ xá»­ lÃ½ Ä‘Æ°á»£c

Tiáº¿n hÃ nh kiá»ƒm tra checkpoint:
```
(football) detection % ls -la ../../models/detection/balanced_train/weights/
total 188456
drwxr-xr-x@  8 tuantai229  staff       256 Mar  6 11:20 .
drwxr-xr-x@ 11 tuantai229  staff       352 Mar  6 11:36 ..
-rw-r--r--@  1 tuantai229  staff  16081748 Mar  6 11:25 best.pt
-rw-r--r--@  1 tuantai229  staff  16074004 Mar  6 09:02 epoch0.pt
-rw-r--r--@  1 tuantai229  staff  16076244 Mar  6 09:48 epoch20.pt
-rw-r--r--@  1 tuantai229  staff  16078804 Mar  6 10:41 epoch40.pt
-rw-r--r--@  1 tuantai229  staff  16081364 Mar  6 11:20 epoch60.pt
-rw-r--r--@  1 tuantai229  staff  16081876 Mar  6 11:26 last.pt
```

- `best.pt`: MÃ´ hÃ¬nh tá»‘t nháº¥t theo metrics Ä‘Ã¡nh giÃ¡
- `last.pt`: MÃ´ hÃ¬nh táº¡i epoch cuá»‘i cÃ¹ng trÆ°á»›c khi gáº·p lá»—i bá»™ nhá»›
- CÃ¡c checkpoint trung gian táº¡i epoch 0, 20, 40, vÃ  60

Viáº¿t file Ä‘Ã¡nh giÃ¡ xem cÃ³ cáº£i thiá»‡n khÃ´ng `src/detection/evaluate_model.py`
```
(football) detection % python evaluate_model.py
Äang Ä‘Ã¡nh giÃ¡ model: ../../models/detection/balanced_train/weights/best.pt
Ultralytics 8.3.81 ðŸš€ Python-3.10.16 torch-2.6.0 MPS (Apple M2 Pro)
YOLO11n summary (fused): 100 layers, 2,582,542 parameters, 0 gradients, 6.3 GFLOPs
val: Scanning /Users/tuantai229/Projects/FootballDnC/dataset/val/labels.cache... 87 images, 0 background
                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                   all         87       1039      0.828        0.5      0.515      0.353
                  ball         86        170      0.765     0.0412     0.0562     0.0168
                player         87        869      0.891       0.96      0.974      0.689
Speed: 1.1ms preprocess, 24.1ms inference, 0.0ms loss, 26.3ms postprocess per image
Results saved to runs/detect/val

Káº¿t quáº£ Ä‘Ã¡nh giÃ¡:
mAP50: 0.515
mAP50-95: 0.353

Káº¿t quáº£ theo lá»›p:
0: mAP50 = 0.017
1: mAP50 = 0.689
```

PhÃ¢n tÃ­ch káº¿t quáº£ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh:

1. ÄÃ£ báº¯t Ä‘áº§u phÃ¡t hiá»‡n Ä‘Æ°á»£c bÃ³ng!
- **TrÆ°á»›c Ä‘Ã¢y**: mAP50 = 0.000 (khÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c bÃ³ng)
- **Hiá»‡n táº¡i**: mAP50 = 0.0562 (Ä‘Ã£ báº¯t Ä‘áº§u phÃ¡t hiá»‡n)

2. PhÃ¢n tÃ­ch chi tiáº¿t tá»«ng lá»›p:

| Lá»›p | Precision | Recall | mAP50 | mAP50-95 |
|-----|-----------|--------|-------|----------|
| Ball | 0.765 | 0.0412 | 0.0562 | 0.0168 |
| Player | 0.891 | 0.960 | 0.974 | 0.689 |
| Overall | 0.828 | 0.500 | 0.515 | 0.353 |

- **Äiá»ƒm máº¡nh**: Khi mÃ´ hÃ¬nh phÃ¡t hiá»‡n bÃ³ng, Ä‘á»™ chÃ­nh xÃ¡c khÃ¡ tá»‘t (Precision = 0.765)
- **Háº¡n cháº¿ chÃ­nh**: Tá»· lá»‡ phÃ¡t hiá»‡n bÃ³ng cÃ²n tháº¥p (Recall = 0.0412), chá»‰ tÃ¬m tháº¥y khoáº£ng 4% sá»‘ quáº£ bÃ³ng

-----
## Train script trÃªn Kaggle vá»›i nhiá»u tham sá»‘ khÃ¡c nhau: src/train_experiment.py

Báº£ng so sÃ¡nh káº¿t quáº£ á»Ÿ src/detection/experiment.xlsx

### Tá»•ng quan cÃ¡c thá»­ nghiá»‡m

6 thá»­ nghiá»‡m khÃ¡c nhau:

1. **Baseline**: YOLOv11n, imgsz=640, tham sá»‘ máº·c Ä‘á»‹nh
2. **Model S**: NÃ¢ng cáº¥p lÃªn YOLOv11s, giá»¯ cÃ¡c tham sá»‘ khÃ¡c khÃ´ng Ä‘á»•i
3. **Imgsz 1280**: TÄƒng kÃ­ch thÆ°á»›c áº£nh tá»« 640 lÃªn 1280, giáº£m batch size
4. **High Loss**: TÄƒng trá»ng sá»‘ box vÃ  cls loss Ä‘á»ƒ cáº£i thiá»‡n phÃ¡t hiá»‡n
5. **Combined**: Káº¿t há»£p model lá»›n (YOLOv11s) + áº£nh lá»›n (1280) + tÄƒng loss
6. **Custom**: Sá»­ dá»¥ng model lá»›n nháº¥t (YOLOv11m), áº£nh lá»›n, tÄƒng loss vÃ  tÄƒng epochs

### PhÃ¢n tÃ­ch chi tiáº¿t

#### PhÃ¡t hiá»‡n bÃ³ng
PhÃ¡t hiá»‡n bÃ³ng lÃ  thÃ¡ch thá»©c lá»›n nháº¥t trong dá»± Ã¡n nÃ y:

| Thá»­ nghiá»‡m | mAP50 BÃ³ng | Recall BÃ³ng | Precision BÃ³ng |
|------------|------------|-------------|----------------|
| 0_baseline | 0.148      | 0.117       | 0.609          |
| 1_model_s  | 0.205      | 0.101       | 0.964          |
| 2_imgsz_1280| 0.400     | 0.337       | 0.901          |
| 3_high_loss| 0.179      | 0.118       | 0.818          |
| 4_combined | 0.574      | 0.419       | 0.967          |
| custom     | 0.598      | 0.459       | 0.932          |

**Nháº­n xÃ©t vá» phÃ¡t hiá»‡n bÃ³ng**:
- TÄƒng kÃ­ch thÆ°á»›c áº£nh (1280) cÃ³ tÃ¡c Ä‘á»™ng tÃ­ch cá»±c nháº¥t Ä‘áº¿n viá»‡c phÃ¡t hiá»‡n bÃ³ng, nÃ¢ng mAP50 tá»« ~0.15 lÃªn 0.40
- Káº¿t há»£p mÃ´ hÃ¬nh lá»›n hÆ¡n (YOLOv11s/YOLOv11m) vá»›i áº£nh lá»›n vÃ  tÄƒng trá»ng sá»‘ loss cho káº¿t quáº£ tá»‘t nháº¥t
- Thá»­ nghiá»‡m custom vá»›i YOLOv11m vÃ  nhiá»u epochs hÆ¡n Ä‘áº¡t káº¿t quáº£ tá»‘t nháº¥t (mAP50 = 0.598)

#### PhÃ¡t hiá»‡n cáº§u thá»§
PhÃ¡t hiá»‡n cáº§u thá»§ tÆ°Æ¡ng Ä‘á»‘i dá»… dÃ ng hÆ¡n vÃ  Ä‘áº¡t káº¿t quáº£ tá»‘t ngay tá»« baseline:

| Thá»­ nghiá»‡m | mAP50 Cáº§u thá»§ | Recall Cáº§u thá»§ | Precision Cáº§u thá»§ |
|------------|---------------|----------------|-------------------|
| 0_baseline | 0.957         | 0.928          | 0.860             |
| 1_model_s  | 0.972         | 0.891          | 0.974             |
| 2_imgsz_1280| 0.962        | 0.922          | 0.880             |
| 3_high_loss| 0.955         | 0.926          | 0.853             |
| 4_combined | 0.992         | 0.982          | 0.981             |
| custom     | 0.993         | 0.989          | 0.983             |

**Nháº­n xÃ©t vá» phÃ¡t hiá»‡n cáº§u thá»§**:
- Ngay tá»« baseline, viá»‡c phÃ¡t hiá»‡n cáº§u thá»§ Ä‘Ã£ ráº¥t tá»‘t (mAP50 = 0.957)
- Viá»‡c káº¿t há»£p model lá»›n vÃ  áº£nh lá»›n trong thá»­ nghiá»‡m 4 vÃ  custom giÃºp cáº£i thiá»‡n lÃªn trÃªn 0.99

#### Hiá»‡u suáº¥t tá»•ng thá»ƒ

| Thá»­ nghiá»‡m | mAP50 | mAP50-95 | Thá»i gian huáº¥n luyá»‡n |
|------------|-------|----------|----------------------|
| 0_baseline | 0.553 | 0.339    | 0.149 giá» (~9 phÃºt)  |
| 1_model_s  | 0.588 | 0.411    | 0.177 giá» (~11 phÃºt) |
| 2_imgsz_1280| 0.694| 0.527    | 0.341 giá» (~20 phÃºt) |
| 3_high_loss| 0.567 | 0.346    | 0.147 giá» (~9 phÃºt)  |
| 4_combined | 0.783 | 0.609    | 0.586 giá» (~35 phÃºt) |
| custom     | 0.796 | 0.652    | 2.642 giá» (~2h38m)   |

### ÄÃ¡nh giÃ¡ vÃ  káº¿t luáº­n

#### ÄÃ¡nh giÃ¡ chung
1. **TÃ¡c Ä‘á»™ng cá»§a kÃ­ch thÆ°á»›c áº£nh**: TÄƒng kÃ­ch thÆ°á»›c áº£nh tá»« 640 lÃªn 1280 mang láº¡i cáº£i thiá»‡n lá»›n nháº¥t, Ä‘áº·c biá»‡t cho viá»‡c phÃ¡t hiá»‡n bÃ³ng. Äiá»u nÃ y há»£p lÃ½ vÃ¬ bÃ³ng lÃ  Ä‘á»‘i tÆ°á»£ng nhá» trong khung hÃ¬nh.

2. **TÃ¡c Ä‘á»™ng cá»§a mÃ´ hÃ¬nh**: YOLOv11s vÃ  YOLOv11m cho káº¿t quáº£ tá»‘t hÆ¡n YOLOv11n, nhÆ°ng Ä‘i kÃ¨m vá»›i chi phÃ­ thá»i gian huáº¥n luyá»‡n tÄƒng lÃªn.

3. **TÃ¡c Ä‘á»™ng cá»§a trá»ng sá»‘ loss**: TÄƒng trá»ng sá»‘ box vÃ  cls loss (tá»« 7.5/0.5 lÃªn 10.0/3.0) cÃ³ tÃ¡c Ä‘á»™ng tÃ­ch cá»±c khi káº¿t há»£p vá»›i mÃ´ hÃ¬nh lá»›n vÃ  kÃ­ch thÆ°á»›c áº£nh lá»›n.

4. **Trade-off hiá»‡u suáº¥t vÃ  thá»i gian**: Thá»­ nghiá»‡m "custom" cho káº¿t quáº£ tá»‘t nháº¥t nhÆ°ng tá»‘n thá»i gian gáº¥p gáº§n 5 láº§n so vá»›i thá»­ nghiá»‡m "4_combined" trong khi chá»‰ cáº£i thiá»‡n mAP50 tá»« 0.783 lÃªn 0.796.

#### Káº¿t luáº­n

- Náº¿u Æ°u tiÃªn tá»‘c Ä‘á»™: Sá»­ dá»¥ng cáº¥u hÃ¬nh tá»« thá»­ nghiá»‡m "2_imgsz_1280" (YOLOv11n vá»›i imgsz=1280)
- Náº¿u Æ°u tiÃªn cháº¥t lÆ°á»£ng vÃ  cÃ³ thá»i gian: Sá»­ dá»¥ng cáº¥u hÃ¬nh tá»« thá»­ nghiá»‡m "4_combined" (YOLOv11s vá»›i imgsz=1280, box=10.0, cls=3.0)

=>
Tham sá»‘ Ä‘á»ƒ sá»­ dá»¥ng: model="yolo11s.pt", imgsz=1280, epochs=100, batch=8, box=10.0, cls=3.0, patience=25

Class        Images   Instances  Box(P          R       mAP50     mAP50-95)
   all        121       1474      0.961      0.713      0.791      0.638
  ball        115        267      0.944      0.441       0.59      0.412
player        121       1207      0.977      0.985      0.993      0.864